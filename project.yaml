version: '3.0'

expectations:

  population_size: 100000

actions:

  ## # # # # # # # # # # # # # # # # # # # 
  ## DO NOT EDIT project.yaml DIRECTLY 
  ## This file is created by create-project.R 
  ## Edit and run create-project.R to update the project.yaml 
  ## # # # # # # # # # # # # # # # # # # # 
  ## # # # # # # # # # # # # # # # # # # # 
  ## Temp second dose info 
  ## # # # # # # # # # # # # # # # # # # # 

  seconddose_extract:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_2dose
      --output-format feather
    outputs:
      highly_sensitive:
        cohort: output/input_2dose.feather

  seconddose_process:
    run: r:latest analysis/seconddose/process.R
    needs:
    - seconddose_extract
    outputs:
      highly_sensitive:
        data: output/data/seconddose_data_processed.rds

  seconddose_graphs:
    run: r:latest analysis/seconddose/graphs.R
    needs:
    - seconddose_process
    outputs:
      moderately_sensitive:
        data: output/seconddose/plots/plot*.png

  ## # # # # # # # # # # # # # # # # # # # 
  ## HCW characteristics 
  ## # # # # # # # # # # # # # # # # # # # 

  hcw_extract:
    run: cohortextractor:latest generate_cohort --study-definition study_definition_hcw
      --output-format feather
    outputs:
      highly_sensitive:
        cohort: output/input_hcw.feather

  hcw_process:
    run: r:latest analysis/hcw/process.R
    needs:
    - hcw_extract
    outputs:
      highly_sensitive:
        data: output/data/hcw_data_processed.rds
        datavax: output/data/hcw_data_vax.rds

  hcw_properties:
    run: r:latest analysis/process/data_properties.R output/data/hcw_data_processed.rds
      output/data_properties
    needs:
    - hcw_process
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/hcw_data_processed*.txt

  hcw_descr:
    run: r:latest analysis/hcw/descr.R
    needs:
    - hcw_process
    outputs:
      moderately_sensitive:
        png: output/hcw/*.png
        svg: output/hcw/*.svg
        html: output/hcw/*.html
        csv: output/hcw/*.csv

  ## # # # # # # # # # # # # # # # # # # # 
  ## Extract and process 
  ## # # # # # # # # # # # # # # # # # # # 

  design:
    run: r:latest analysis/process/design.R
    outputs:
      moderately_sensitive:
        metadata: output/data/metadata*

  extract:
    run: cohortextractor:latest generate_cohort --study-definition study_definition
      --output-format feather
    needs:
    - design
    outputs:
      highly_sensitive:
        cohort: output/input.feather

  data_process:
    run: r:latest analysis/process/data_process.R
    needs:
    - design
    - extract
    outputs:
      highly_sensitive:
        processed: output/data/data_processed.rds

  data_properties:
    run: r:latest analysis/process/data_properties.R output/data/data_processed.rds
      output/data_properties
    needs:
    - data_process
    outputs:
      moderately_sensitive:
        cohort: output/data_properties/data_processed*.txt

  data_selection:
    run: r:latest analysis/process/data_selection.R
    needs:
    - design
    - data_process
    outputs:
      highly_sensitive:
        data_allvax: output/data/data_cohort_allvax.rds
        data: output/data/data_cohort.rds
      moderately_sensitive:
        flow: output/data/flowchart.csv

  ## # # # # # # # # # # # # # # # # # # # 
  ## Descriptive stats 
  ## # # # # # # # # # # # # # # # # # # # 

  descr_table1:
    run: r:latest analysis/descriptive/table1.R
    needs:
    - design
    - data_selection
    outputs:
      moderately_sensitive:
        html: output/descriptive/tables/table1*.html
        csv: output/descriptive/tables/table1*.csv

  descr_table1_allvax:
    run: r:latest analysis/descriptive/table1_allvax.R
    needs:
    - design
    - data_selection
    outputs:
      moderately_sensitive:
        html: output/descriptive/tables/table1_allvax*.html
        csv: output/descriptive/tables/table1_allvax*.csv

  descr_irr:
    run: r:latest analysis/descriptive/table_irr.R output/data/data_processed.rds
      output/data_properties
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/descriptive/tables/table_irr*.rds
      moderately_sensitive:
        html: output/descriptive/tables/table_irr*.html
        csv: output/descriptive/tables/table_irr*.csv

  descr_km:
    run: r:latest analysis/descriptive/km.R output/data/data_processed.rds output/data_properties
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/descriptive/km/plot_survival*.rds
      moderately_sensitive:
        png: output/descriptive/km/plot_survival*.png
        svg: output/descriptive/km/plot_survival*.svg

  descr_vaxdate:
    run: r:latest analysis/descriptive/vax_date.R
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/descriptive/vaxdate/*.rds
      moderately_sensitive:
        png: output/descriptive/vaxdate/*.png
        pdf: output/descriptive/vaxdate/*.pdf
        svg: output/descriptive/vaxdate/*.svg

  descr_seconddose:
    run: r:latest analysis/descriptive/seconddose.R
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/descriptive/seconddose/*.rds
      moderately_sensitive:
        png: output/descriptive/seconddose/*.png
        pdf: output/descriptive/seconddose/*.pdf
        csv: output/descriptive/seconddose/*.csv

  descr_eventdate:
    run: r:latest analysis/descriptive/event_date.R
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/descriptive/eventdate/*.rds
      moderately_sensitive:
        png: output/descriptive/eventdate/*.png
        pdf: output/descriptive/eventdate/*.pdf
        svg: output/descriptive/eventdate/*.svg

  ## # # # # # # # # # # # # # # # # # # # 
  ## Models 
  ## # # # # # # # # # # # # # # # # # # # 
  ## ###  Positive SARS-CoV-2 Test 

  model_postest_timesincevax_1_cox:
    run: r:latest analysis/models/model_cox.R postest timesincevax 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/1/modelcox*.txt
        csv: output/models/postest/timesincevax/1/modelcox*.csv

  report_postest_timesincevax_1_cox:
    run: r:latest analysis/models/report_cox.R postest timesincevax 1
    needs:
    - design
    - model_postest_timesincevax_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/1/reportcox_*.csv
        svg: output/models/postest/timesincevax/1/reportcox_*.svg
        png: output/models/postest/timesincevax/1/reportcox_*.png

  model_postest_calendar_1_cox:
    run: r:latest analysis/models/model_cox.R postest calendar 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/postest/calendar/1/modelcox*.txt
        csv: output/models/postest/calendar/1/modelcox*.csv

  report_postest_calendar_1_cox:
    run: r:latest analysis/models/report_cox.R postest calendar 1
    needs:
    - design
    - model_postest_calendar_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/postest/calendar/1/reportcox_*.csv
        svg: output/models/postest/calendar/1/reportcox_*.svg
        png: output/models/postest/calendar/1/reportcox_*.png

  model_postest_timesincevax_1_plr:
    run: r:latest analysis/models/model_plr.R postest timesincevax 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/1/modelplr*.txt
        csv: output/models/postest/timesincevax/1/modelplr*.csv

  report_postest_timesincevax_1_plr:
    run: r:latest analysis/models/report_plr.R postest timesincevax 1
    needs:
    - design
    - model_postest_timesincevax_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/1/reportplr_*.csv
        svg: output/models/postest/timesincevax/1/reportplr_*.svg
        png: output/models/postest/timesincevax/1/reportplr_*.png

  model_postest_calendar_1_plr:
    run: r:latest analysis/models/model_plr.R postest calendar 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/calendar/1/modelplr*.txt
        csv: output/models/postest/calendar/1/modelplr*.csv

  report_postest_calendar_1_plr:
    run: r:latest analysis/models/report_plr.R postest calendar 1
    needs:
    - design
    - model_postest_calendar_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/calendar/1/reportplr_*.csv
        svg: output/models/postest/calendar/1/reportplr_*.svg
        png: output/models/postest/calendar/1/reportplr_*.png

  model_postest_timesincevax_0_cox:
    run: r:latest analysis/models/model_cox.R postest timesincevax 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/0/modelcox*.txt
        csv: output/models/postest/timesincevax/0/modelcox*.csv

  report_postest_timesincevax_0_cox:
    run: r:latest analysis/models/report_cox.R postest timesincevax 0
    needs:
    - design
    - model_postest_timesincevax_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/0/reportcox_*.csv
        svg: output/models/postest/timesincevax/0/reportcox_*.svg
        png: output/models/postest/timesincevax/0/reportcox_*.png

  model_postest_calendar_0_cox:
    run: r:latest analysis/models/model_cox.R postest calendar 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/postest/calendar/0/modelcox*.txt
        csv: output/models/postest/calendar/0/modelcox*.csv

  report_postest_calendar_0_cox:
    run: r:latest analysis/models/report_cox.R postest calendar 0
    needs:
    - design
    - model_postest_calendar_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/postest/calendar/0/reportcox_*.csv
        svg: output/models/postest/calendar/0/reportcox_*.svg
        png: output/models/postest/calendar/0/reportcox_*.png

  model_postest_timesincevax_0_plr:
    run: r:latest analysis/models/model_plr.R postest timesincevax 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/0/modelplr*.txt
        csv: output/models/postest/timesincevax/0/modelplr*.csv

  report_postest_timesincevax_0_plr:
    run: r:latest analysis/models/report_plr.R postest timesincevax 0
    needs:
    - design
    - model_postest_timesincevax_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/0/reportplr_*.csv
        svg: output/models/postest/timesincevax/0/reportplr_*.svg
        png: output/models/postest/timesincevax/0/reportplr_*.png

  model_postest_calendar_0_plr:
    run: r:latest analysis/models/model_plr.R postest calendar 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/calendar/0/modelplr*.txt
        csv: output/models/postest/calendar/0/modelplr*.csv

  report_postest_calendar_0_plr:
    run: r:latest analysis/models/report_plr.R postest calendar 0
    needs:
    - design
    - model_postest_calendar_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/calendar/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/calendar/0/reportplr_*.csv
        svg: output/models/postest/calendar/0/reportplr_*.svg
        png: output/models/postest/calendar/0/reportplr_*.png

  ## ###  A&E attendence 

  model_emergency_timesincevax_1_cox:
    run: r:latest analysis/models/model_cox.R emergency timesincevax 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/1/modelcox*.txt
        csv: output/models/emergency/timesincevax/1/modelcox*.csv

  report_emergency_timesincevax_1_cox:
    run: r:latest analysis/models/report_cox.R emergency timesincevax 1
    needs:
    - design
    - model_emergency_timesincevax_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/1/reportcox_*.csv
        svg: output/models/emergency/timesincevax/1/reportcox_*.svg
        png: output/models/emergency/timesincevax/1/reportcox_*.png

  model_emergency_calendar_1_cox:
    run: r:latest analysis/models/model_cox.R emergency calendar 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/emergency/calendar/1/modelcox*.txt
        csv: output/models/emergency/calendar/1/modelcox*.csv

  report_emergency_calendar_1_cox:
    run: r:latest analysis/models/report_cox.R emergency calendar 1
    needs:
    - design
    - model_emergency_calendar_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/emergency/calendar/1/reportcox_*.csv
        svg: output/models/emergency/calendar/1/reportcox_*.svg
        png: output/models/emergency/calendar/1/reportcox_*.png

  model_emergency_timesincevax_1_plr:
    run: r:latest analysis/models/model_plr.R emergency timesincevax 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/1/modelplr*.txt
        csv: output/models/emergency/timesincevax/1/modelplr*.csv

  report_emergency_timesincevax_1_plr:
    run: r:latest analysis/models/report_plr.R emergency timesincevax 1
    needs:
    - design
    - model_emergency_timesincevax_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/1/reportplr_*.csv
        svg: output/models/emergency/timesincevax/1/reportplr_*.svg
        png: output/models/emergency/timesincevax/1/reportplr_*.png

  model_emergency_calendar_1_plr:
    run: r:latest analysis/models/model_plr.R emergency calendar 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/calendar/1/modelplr*.txt
        csv: output/models/emergency/calendar/1/modelplr*.csv

  report_emergency_calendar_1_plr:
    run: r:latest analysis/models/report_plr.R emergency calendar 1
    needs:
    - design
    - model_emergency_calendar_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/calendar/1/reportplr_*.csv
        svg: output/models/emergency/calendar/1/reportplr_*.svg
        png: output/models/emergency/calendar/1/reportplr_*.png

  model_emergency_timesincevax_0_cox:
    run: r:latest analysis/models/model_cox.R emergency timesincevax 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/0/modelcox*.txt
        csv: output/models/emergency/timesincevax/0/modelcox*.csv

  report_emergency_timesincevax_0_cox:
    run: r:latest analysis/models/report_cox.R emergency timesincevax 0
    needs:
    - design
    - model_emergency_timesincevax_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/0/reportcox_*.csv
        svg: output/models/emergency/timesincevax/0/reportcox_*.svg
        png: output/models/emergency/timesincevax/0/reportcox_*.png

  model_emergency_calendar_0_cox:
    run: r:latest analysis/models/model_cox.R emergency calendar 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/emergency/calendar/0/modelcox*.txt
        csv: output/models/emergency/calendar/0/modelcox*.csv

  report_emergency_calendar_0_cox:
    run: r:latest analysis/models/report_cox.R emergency calendar 0
    needs:
    - design
    - model_emergency_calendar_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/emergency/calendar/0/reportcox_*.csv
        svg: output/models/emergency/calendar/0/reportcox_*.svg
        png: output/models/emergency/calendar/0/reportcox_*.png

  model_emergency_timesincevax_0_plr:
    run: r:latest analysis/models/model_plr.R emergency timesincevax 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/0/modelplr*.txt
        csv: output/models/emergency/timesincevax/0/modelplr*.csv

  report_emergency_timesincevax_0_plr:
    run: r:latest analysis/models/report_plr.R emergency timesincevax 0
    needs:
    - design
    - model_emergency_timesincevax_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/0/reportplr_*.csv
        svg: output/models/emergency/timesincevax/0/reportplr_*.svg
        png: output/models/emergency/timesincevax/0/reportplr_*.png

  model_emergency_calendar_0_plr:
    run: r:latest analysis/models/model_plr.R emergency calendar 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/calendar/0/modelplr*.txt
        csv: output/models/emergency/calendar/0/modelplr*.csv

  report_emergency_calendar_0_plr:
    run: r:latest analysis/models/report_plr.R emergency calendar 0
    needs:
    - design
    - model_emergency_calendar_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/calendar/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/calendar/0/reportplr_*.csv
        svg: output/models/emergency/calendar/0/reportplr_*.svg
        png: output/models/emergency/calendar/0/reportplr_*.png

  ## ###  COVID-19 A&E attendence 

  model_covidemergency_timesincevax_1_cox:
    run: r:latest analysis/models/model_cox.R covidemergency timesincevax 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/1/modelcox*.txt
        csv: output/models/covidemergency/timesincevax/1/modelcox*.csv

  report_covidemergency_timesincevax_1_cox:
    run: r:latest analysis/models/report_cox.R covidemergency timesincevax 1
    needs:
    - design
    - model_covidemergency_timesincevax_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/1/reportcox_*.csv
        svg: output/models/covidemergency/timesincevax/1/reportcox_*.svg
        png: output/models/covidemergency/timesincevax/1/reportcox_*.png

  model_covidemergency_calendar_1_cox:
    run: r:latest analysis/models/model_cox.R covidemergency calendar 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/calendar/1/modelcox*.txt
        csv: output/models/covidemergency/calendar/1/modelcox*.csv

  report_covidemergency_calendar_1_cox:
    run: r:latest analysis/models/report_cox.R covidemergency calendar 1
    needs:
    - design
    - model_covidemergency_calendar_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/calendar/1/reportcox_*.csv
        svg: output/models/covidemergency/calendar/1/reportcox_*.svg
        png: output/models/covidemergency/calendar/1/reportcox_*.png

  model_covidemergency_timesincevax_1_plr:
    run: r:latest analysis/models/model_plr.R covidemergency timesincevax 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/1/modelplr*.txt
        csv: output/models/covidemergency/timesincevax/1/modelplr*.csv

  report_covidemergency_timesincevax_1_plr:
    run: r:latest analysis/models/report_plr.R covidemergency timesincevax 1
    needs:
    - design
    - model_covidemergency_timesincevax_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/1/reportplr_*.csv
        svg: output/models/covidemergency/timesincevax/1/reportplr_*.svg
        png: output/models/covidemergency/timesincevax/1/reportplr_*.png

  model_covidemergency_calendar_1_plr:
    run: r:latest analysis/models/model_plr.R covidemergency calendar 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/calendar/1/modelplr*.txt
        csv: output/models/covidemergency/calendar/1/modelplr*.csv

  report_covidemergency_calendar_1_plr:
    run: r:latest analysis/models/report_plr.R covidemergency calendar 1
    needs:
    - design
    - model_covidemergency_calendar_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/calendar/1/reportplr_*.csv
        svg: output/models/covidemergency/calendar/1/reportplr_*.svg
        png: output/models/covidemergency/calendar/1/reportplr_*.png

  model_covidemergency_timesincevax_0_cox:
    run: r:latest analysis/models/model_cox.R covidemergency timesincevax 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/0/modelcox*.txt
        csv: output/models/covidemergency/timesincevax/0/modelcox*.csv

  report_covidemergency_timesincevax_0_cox:
    run: r:latest analysis/models/report_cox.R covidemergency timesincevax 0
    needs:
    - design
    - model_covidemergency_timesincevax_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/0/reportcox_*.csv
        svg: output/models/covidemergency/timesincevax/0/reportcox_*.svg
        png: output/models/covidemergency/timesincevax/0/reportcox_*.png

  model_covidemergency_calendar_0_cox:
    run: r:latest analysis/models/model_cox.R covidemergency calendar 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/calendar/0/modelcox*.txt
        csv: output/models/covidemergency/calendar/0/modelcox*.csv

  report_covidemergency_calendar_0_cox:
    run: r:latest analysis/models/report_cox.R covidemergency calendar 0
    needs:
    - design
    - model_covidemergency_calendar_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/calendar/0/reportcox_*.csv
        svg: output/models/covidemergency/calendar/0/reportcox_*.svg
        png: output/models/covidemergency/calendar/0/reportcox_*.png

  model_covidemergency_timesincevax_0_plr:
    run: r:latest analysis/models/model_plr.R covidemergency timesincevax 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/0/modelplr*.txt
        csv: output/models/covidemergency/timesincevax/0/modelplr*.csv

  report_covidemergency_timesincevax_0_plr:
    run: r:latest analysis/models/report_plr.R covidemergency timesincevax 0
    needs:
    - design
    - model_covidemergency_timesincevax_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/0/reportplr_*.csv
        svg: output/models/covidemergency/timesincevax/0/reportplr_*.svg
        png: output/models/covidemergency/timesincevax/0/reportplr_*.png

  model_covidemergency_calendar_0_plr:
    run: r:latest analysis/models/model_plr.R covidemergency calendar 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/calendar/0/modelplr*.txt
        csv: output/models/covidemergency/calendar/0/modelplr*.csv

  report_covidemergency_calendar_0_plr:
    run: r:latest analysis/models/report_plr.R covidemergency calendar 0
    needs:
    - design
    - model_covidemergency_calendar_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/calendar/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/calendar/0/reportplr_*.csv
        svg: output/models/covidemergency/calendar/0/reportplr_*.svg
        png: output/models/covidemergency/calendar/0/reportplr_*.png

  ## ### Unplanned Hospital admission 

  model_admitted_timesincevax_1_cox:
    run: r:latest analysis/models/model_cox.R admitted timesincevax 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/1/modelcox*.txt
        csv: output/models/admitted/timesincevax/1/modelcox*.csv

  report_admitted_timesincevax_1_cox:
    run: r:latest analysis/models/report_cox.R admitted timesincevax 1
    needs:
    - design
    - model_admitted_timesincevax_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/1/reportcox_*.csv
        svg: output/models/admitted/timesincevax/1/reportcox_*.svg
        png: output/models/admitted/timesincevax/1/reportcox_*.png

  model_admitted_calendar_1_cox:
    run: r:latest analysis/models/model_cox.R admitted calendar 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/admitted/calendar/1/modelcox*.txt
        csv: output/models/admitted/calendar/1/modelcox*.csv

  report_admitted_calendar_1_cox:
    run: r:latest analysis/models/report_cox.R admitted calendar 1
    needs:
    - design
    - model_admitted_calendar_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/admitted/calendar/1/reportcox_*.csv
        svg: output/models/admitted/calendar/1/reportcox_*.svg
        png: output/models/admitted/calendar/1/reportcox_*.png

  model_admitted_timesincevax_1_plr:
    run: r:latest analysis/models/model_plr.R admitted timesincevax 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/1/modelplr*.txt
        csv: output/models/admitted/timesincevax/1/modelplr*.csv

  report_admitted_timesincevax_1_plr:
    run: r:latest analysis/models/report_plr.R admitted timesincevax 1
    needs:
    - design
    - model_admitted_timesincevax_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/1/reportplr_*.csv
        svg: output/models/admitted/timesincevax/1/reportplr_*.svg
        png: output/models/admitted/timesincevax/1/reportplr_*.png

  model_admitted_calendar_1_plr:
    run: r:latest analysis/models/model_plr.R admitted calendar 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/calendar/1/modelplr*.txt
        csv: output/models/admitted/calendar/1/modelplr*.csv

  report_admitted_calendar_1_plr:
    run: r:latest analysis/models/report_plr.R admitted calendar 1
    needs:
    - design
    - model_admitted_calendar_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/calendar/1/reportplr_*.csv
        svg: output/models/admitted/calendar/1/reportplr_*.svg
        png: output/models/admitted/calendar/1/reportplr_*.png

  model_admitted_timesincevax_0_cox:
    run: r:latest analysis/models/model_cox.R admitted timesincevax 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/0/modelcox*.txt
        csv: output/models/admitted/timesincevax/0/modelcox*.csv

  report_admitted_timesincevax_0_cox:
    run: r:latest analysis/models/report_cox.R admitted timesincevax 0
    needs:
    - design
    - model_admitted_timesincevax_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/0/reportcox_*.csv
        svg: output/models/admitted/timesincevax/0/reportcox_*.svg
        png: output/models/admitted/timesincevax/0/reportcox_*.png

  model_admitted_calendar_0_cox:
    run: r:latest analysis/models/model_cox.R admitted calendar 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/admitted/calendar/0/modelcox*.txt
        csv: output/models/admitted/calendar/0/modelcox*.csv

  report_admitted_calendar_0_cox:
    run: r:latest analysis/models/report_cox.R admitted calendar 0
    needs:
    - design
    - model_admitted_calendar_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/admitted/calendar/0/reportcox_*.csv
        svg: output/models/admitted/calendar/0/reportcox_*.svg
        png: output/models/admitted/calendar/0/reportcox_*.png

  model_admitted_timesincevax_0_plr:
    run: r:latest analysis/models/model_plr.R admitted timesincevax 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/0/modelplr*.txt
        csv: output/models/admitted/timesincevax/0/modelplr*.csv

  report_admitted_timesincevax_0_plr:
    run: r:latest analysis/models/report_plr.R admitted timesincevax 0
    needs:
    - design
    - model_admitted_timesincevax_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/0/reportplr_*.csv
        svg: output/models/admitted/timesincevax/0/reportplr_*.svg
        png: output/models/admitted/timesincevax/0/reportplr_*.png

  model_admitted_calendar_0_plr:
    run: r:latest analysis/models/model_plr.R admitted calendar 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/calendar/0/modelplr*.txt
        csv: output/models/admitted/calendar/0/modelplr*.csv

  report_admitted_calendar_0_plr:
    run: r:latest analysis/models/report_plr.R admitted calendar 0
    needs:
    - design
    - model_admitted_calendar_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/calendar/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/calendar/0/reportplr_*.csv
        svg: output/models/admitted/calendar/0/reportplr_*.svg
        png: output/models/admitted/calendar/0/reportplr_*.png

  ## ###  COVID-19 hospital admission 

  model_covidadmitted_timesincevax_1_cox:
    run: r:latest analysis/models/model_cox.R covidadmitted timesincevax 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/1/modelcox*.txt
        csv: output/models/covidadmitted/timesincevax/1/modelcox*.csv

  report_covidadmitted_timesincevax_1_cox:
    run: r:latest analysis/models/report_cox.R covidadmitted timesincevax 1
    needs:
    - design
    - model_covidadmitted_timesincevax_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/1/reportcox_*.csv
        svg: output/models/covidadmitted/timesincevax/1/reportcox_*.svg
        png: output/models/covidadmitted/timesincevax/1/reportcox_*.png

  model_covidadmitted_calendar_1_cox:
    run: r:latest analysis/models/model_cox.R covidadmitted calendar 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/1/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/calendar/1/modelcox*.txt
        csv: output/models/covidadmitted/calendar/1/modelcox*.csv

  report_covidadmitted_calendar_1_cox:
    run: r:latest analysis/models/report_cox.R covidadmitted calendar 1
    needs:
    - design
    - model_covidadmitted_calendar_1_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/1/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/calendar/1/reportcox_*.csv
        svg: output/models/covidadmitted/calendar/1/reportcox_*.svg
        png: output/models/covidadmitted/calendar/1/reportcox_*.png

  model_covidadmitted_timesincevax_1_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted timesincevax 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/1/modelplr*.txt
        csv: output/models/covidadmitted/timesincevax/1/modelplr*.csv

  report_covidadmitted_timesincevax_1_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted timesincevax 1
    needs:
    - design
    - model_covidadmitted_timesincevax_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/1/reportplr_*.csv
        svg: output/models/covidadmitted/timesincevax/1/reportplr_*.svg
        png: output/models/covidadmitted/timesincevax/1/reportplr_*.png

  model_covidadmitted_calendar_1_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted calendar 1 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/calendar/1/modelplr*.txt
        csv: output/models/covidadmitted/calendar/1/modelplr*.csv

  report_covidadmitted_calendar_1_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted calendar 1
    needs:
    - design
    - model_covidadmitted_calendar_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/calendar/1/reportplr_*.csv
        svg: output/models/covidadmitted/calendar/1/reportplr_*.svg
        png: output/models/covidadmitted/calendar/1/reportplr_*.png

  model_covidadmitted_timesincevax_0_cox:
    run: r:latest analysis/models/model_cox.R covidadmitted timesincevax 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/0/modelcox*.txt
        csv: output/models/covidadmitted/timesincevax/0/modelcox*.csv

  report_covidadmitted_timesincevax_0_cox:
    run: r:latest analysis/models/report_cox.R covidadmitted timesincevax 0
    needs:
    - design
    - model_covidadmitted_timesincevax_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/0/reportcox_*.csv
        svg: output/models/covidadmitted/timesincevax/0/reportcox_*.svg
        png: output/models/covidadmitted/timesincevax/0/reportcox_*.png

  model_covidadmitted_calendar_0_cox:
    run: r:latest analysis/models/model_cox.R covidadmitted calendar 0
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/0/modelcox*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/calendar/0/modelcox*.txt
        csv: output/models/covidadmitted/calendar/0/modelcox*.csv

  report_covidadmitted_calendar_0_cox:
    run: r:latest analysis/models/report_cox.R covidadmitted calendar 0
    needs:
    - design
    - model_covidadmitted_calendar_0_cox
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/0/reportcox_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/calendar/0/reportcox_*.csv
        svg: output/models/covidadmitted/calendar/0/reportcox_*.svg
        png: output/models/covidadmitted/calendar/0/reportcox_*.png

  model_covidadmitted_timesincevax_0_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted timesincevax 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/0/modelplr*.txt
        csv: output/models/covidadmitted/timesincevax/0/modelplr*.csv

  report_covidadmitted_timesincevax_0_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted timesincevax 0
    needs:
    - design
    - model_covidadmitted_timesincevax_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/0/reportplr_*.csv
        svg: output/models/covidadmitted/timesincevax/0/reportplr_*.svg
        png: output/models/covidadmitted/timesincevax/0/reportplr_*.png

  model_covidadmitted_calendar_0_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted calendar 0 50000
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/0/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/calendar/0/modelplr*.txt
        csv: output/models/covidadmitted/calendar/0/modelplr*.csv

  report_covidadmitted_calendar_0_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted calendar 0
    needs:
    - design
    - model_covidadmitted_calendar_0_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/calendar/0/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/calendar/0/reportplr_*.csv
        svg: output/models/covidadmitted/calendar/0/reportplr_*.svg
        png: output/models/covidadmitted/calendar/0/reportplr_*.png

  ## # # # # # # # # # # # # # # # # # # # 
  ## sensitivity -- exclude prior infection 
  ## # # # # # # # # # # # # # # # # # # # 
  ## ###  Positive SARS-CoV-2 Test 

  model_postest_timesincevax_1_1_plr:
    run: r:latest analysis/models/model_plr.R postest timesincevax 1 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/1/1/modelplr*.txt
        csv: output/models/postest/timesincevax/1/1/modelplr*.csv

  report_postest_timesincevax_1_1_plr:
    run: r:latest analysis/models/report_plr.R postest timesincevax 1 1
    needs:
    - design
    - model_postest_timesincevax_1_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/1/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/1/1/reportplr_*.csv
        svg: output/models/postest/timesincevax/1/1/reportplr_*.svg
        png: output/models/postest/timesincevax/1/1/reportplr_*.png

  model_postest_timesincevax_0_1_plr:
    run: r:latest analysis/models/model_plr.R postest timesincevax 0 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/postest/timesincevax/0/1/modelplr*.txt
        csv: output/models/postest/timesincevax/0/1/modelplr*.csv

  report_postest_timesincevax_0_1_plr:
    run: r:latest analysis/models/report_plr.R postest timesincevax 0 1
    needs:
    - design
    - model_postest_timesincevax_0_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/postest/timesincevax/0/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/postest/timesincevax/0/1/reportplr_*.csv
        svg: output/models/postest/timesincevax/0/1/reportplr_*.svg
        png: output/models/postest/timesincevax/0/1/reportplr_*.png

  ## ###  A&E attendence 

  model_emergency_timesincevax_1_1_plr:
    run: r:latest analysis/models/model_plr.R emergency timesincevax 1 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/1/1/modelplr*.txt
        csv: output/models/emergency/timesincevax/1/1/modelplr*.csv

  report_emergency_timesincevax_1_1_plr:
    run: r:latest analysis/models/report_plr.R emergency timesincevax 1 1
    needs:
    - design
    - model_emergency_timesincevax_1_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/1/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/1/1/reportplr_*.csv
        svg: output/models/emergency/timesincevax/1/1/reportplr_*.svg
        png: output/models/emergency/timesincevax/1/1/reportplr_*.png

  model_emergency_timesincevax_0_1_plr:
    run: r:latest analysis/models/model_plr.R emergency timesincevax 0 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/emergency/timesincevax/0/1/modelplr*.txt
        csv: output/models/emergency/timesincevax/0/1/modelplr*.csv

  report_emergency_timesincevax_0_1_plr:
    run: r:latest analysis/models/report_plr.R emergency timesincevax 0 1
    needs:
    - design
    - model_emergency_timesincevax_0_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/emergency/timesincevax/0/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/emergency/timesincevax/0/1/reportplr_*.csv
        svg: output/models/emergency/timesincevax/0/1/reportplr_*.svg
        png: output/models/emergency/timesincevax/0/1/reportplr_*.png

  ## ###  COVID-19 A&E attendence 

  model_covidemergency_timesincevax_1_1_plr:
    run: r:latest analysis/models/model_plr.R covidemergency timesincevax 1 50000
      1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/1/1/modelplr*.txt
        csv: output/models/covidemergency/timesincevax/1/1/modelplr*.csv

  report_covidemergency_timesincevax_1_1_plr:
    run: r:latest analysis/models/report_plr.R covidemergency timesincevax 1 1
    needs:
    - design
    - model_covidemergency_timesincevax_1_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/1/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/1/1/reportplr_*.csv
        svg: output/models/covidemergency/timesincevax/1/1/reportplr_*.svg
        png: output/models/covidemergency/timesincevax/1/1/reportplr_*.png

  model_covidemergency_timesincevax_0_1_plr:
    run: r:latest analysis/models/model_plr.R covidemergency timesincevax 0 50000
      1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidemergency/timesincevax/0/1/modelplr*.txt
        csv: output/models/covidemergency/timesincevax/0/1/modelplr*.csv

  report_covidemergency_timesincevax_0_1_plr:
    run: r:latest analysis/models/report_plr.R covidemergency timesincevax 0 1
    needs:
    - design
    - model_covidemergency_timesincevax_0_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidemergency/timesincevax/0/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidemergency/timesincevax/0/1/reportplr_*.csv
        svg: output/models/covidemergency/timesincevax/0/1/reportplr_*.svg
        png: output/models/covidemergency/timesincevax/0/1/reportplr_*.png

  ## ### Unplanned Hospital admission 

  model_admitted_timesincevax_1_1_plr:
    run: r:latest analysis/models/model_plr.R admitted timesincevax 1 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/1/1/modelplr*.txt
        csv: output/models/admitted/timesincevax/1/1/modelplr*.csv

  report_admitted_timesincevax_1_1_plr:
    run: r:latest analysis/models/report_plr.R admitted timesincevax 1 1
    needs:
    - design
    - model_admitted_timesincevax_1_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/1/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/1/1/reportplr_*.csv
        svg: output/models/admitted/timesincevax/1/1/reportplr_*.svg
        png: output/models/admitted/timesincevax/1/1/reportplr_*.png

  model_admitted_timesincevax_0_1_plr:
    run: r:latest analysis/models/model_plr.R admitted timesincevax 0 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/admitted/timesincevax/0/1/modelplr*.txt
        csv: output/models/admitted/timesincevax/0/1/modelplr*.csv

  report_admitted_timesincevax_0_1_plr:
    run: r:latest analysis/models/report_plr.R admitted timesincevax 0 1
    needs:
    - design
    - model_admitted_timesincevax_0_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/admitted/timesincevax/0/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/admitted/timesincevax/0/1/reportplr_*.csv
        svg: output/models/admitted/timesincevax/0/1/reportplr_*.svg
        png: output/models/admitted/timesincevax/0/1/reportplr_*.png

  ## ###  COVID-19 hospital admission 

  model_covidadmitted_timesincevax_1_1_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted timesincevax 1 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/1/1/modelplr*.txt
        csv: output/models/covidadmitted/timesincevax/1/1/modelplr*.csv

  report_covidadmitted_timesincevax_1_1_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted timesincevax 1 1
    needs:
    - design
    - model_covidadmitted_timesincevax_1_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/1/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/1/1/reportplr_*.csv
        svg: output/models/covidadmitted/timesincevax/1/1/reportplr_*.svg
        png: output/models/covidadmitted/timesincevax/1/1/reportplr_*.png

  model_covidadmitted_timesincevax_0_1_plr:
    run: r:latest analysis/models/model_plr.R covidadmitted timesincevax 0 50000 1
    needs:
    - design
    - data_selection
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/1/modelplr*.rds
      moderately_sensitive:
        txt: output/models/covidadmitted/timesincevax/0/1/modelplr*.txt
        csv: output/models/covidadmitted/timesincevax/0/1/modelplr*.csv

  report_covidadmitted_timesincevax_0_1_plr:
    run: r:latest analysis/models/report_plr.R covidadmitted timesincevax 0 1
    needs:
    - design
    - model_covidadmitted_timesincevax_0_1_plr
    outputs:
      highly_sensitive:
        rds: output/models/covidadmitted/timesincevax/0/1/reportplr_*.rds
      moderately_sensitive:
        csv: output/models/covidadmitted/timesincevax/0/1/reportplr_*.csv
        svg: output/models/covidadmitted/timesincevax/0/1/reportplr_*.svg
        png: output/models/covidadmitted/timesincevax/0/1/reportplr_*.png

  ## # # # # # # # # # # # # # # # # # # # 
  ## Reports 
  ## # # # # # # # # # # # # # # # # # # # 

  report_objects:
    run: r:latest analysis/report/report-objects.R
    needs:
    - design
    - data_selection
    - report_postest_timesincevax_0_plr
    - report_postest_timesincevax_1_plr
    - report_covidemergency_timesincevax_0_plr
    - report_covidemergency_timesincevax_1_plr
    - report_covidadmitted_timesincevax_0_plr
    - report_covidadmitted_timesincevax_1_plr
    outputs:
      moderately_sensitive:
        out: output/report/objects/*

  report_objects_sensitivity:
    run: r:latest analysis/report/report-objects-sensitivity.R
    needs:
    - design
    - data_selection
    - report_postest_timesincevax_0_1_plr
    - report_postest_timesincevax_1_1_plr
    - report_covidemergency_timesincevax_0_1_plr
    - report_covidemergency_timesincevax_1_1_plr
    - report_covidadmitted_timesincevax_0_1_plr
    - report_covidadmitted_timesincevax_1_1_plr
    outputs:
      moderately_sensitive:
        out: output/report/objects/sensitivity/exclude_prior_infection/*

  rmd_report:
    run: r:latest -e 'rmarkdown::render("analysis/report/effectiveness_report.Rmd",  knit_root_dir
      = "/workspace",  output_dir = "/workspace/output/report", output_format = c("html_document")   )'
    needs:
    - design
    - data_selection
    - descr_table1
    - descr_irr
    - descr_km
    - descr_vaxdate
    - report_postest_timesincevax_1_plr
    - report_emergency_timesincevax_1_plr
    - report_covidemergency_timesincevax_1_plr
    - report_admitted_timesincevax_1_plr
    - report_covidadmitted_timesincevax_1_plr
    outputs:
      moderately_sensitive:
        html: output/report/effectiveness_report.html
        md: output/report/effectiveness_report.md

  rmd_report_models:
    run: r:latest -e 'rmarkdown::render("analysis/report/effectiveness_report_comparemodels.Rmd",  knit_root_dir
      = "/workspace",  output_dir = "/workspace/output/report", output_format = c("rmarkdown::github_document")   )'
    needs:
    - design
    - data_selection
    - descr_table1
    - descr_irr
    - descr_km
    - descr_vaxdate
    - report_postest_timesincevax_0_cox
    - report_postest_timesincevax_1_cox
    - report_postest_calendar_0_cox
    - report_postest_calendar_1_cox
    - report_postest_timesincevax_0_plr
    - report_postest_timesincevax_1_plr
    - report_postest_calendar_0_plr
    - report_postest_calendar_1_plr
    - report_covidemergency_timesincevax_0_cox
    - report_covidemergency_timesincevax_1_cox
    - report_covidemergency_calendar_0_cox
    - report_covidemergency_calendar_1_cox
    - report_covidemergency_timesincevax_0_plr
    - report_covidemergency_timesincevax_1_plr
    - report_covidemergency_calendar_0_plr
    - report_covidemergency_calendar_1_plr
    - report_covidadmitted_timesincevax_0_cox
    - report_covidadmitted_timesincevax_1_cox
    - report_covidadmitted_calendar_0_cox
    - report_covidadmitted_calendar_1_cox
    - report_covidadmitted_timesincevax_0_plr
    - report_covidadmitted_timesincevax_1_plr
    - report_covidadmitted_calendar_0_plr
    - report_covidadmitted_calendar_1_plr
    outputs:
      moderately_sensitive:
        html: output/report/effectiveness_report_comparemodels.html
        md: output/report/effectiveness_report_comparemodels.md
        figures: output/report/figures_timescales/*.png

